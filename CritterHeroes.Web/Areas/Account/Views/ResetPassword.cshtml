@model CritterHeroes.Web.Areas.Account.Models.ResetPasswordModel

@{
    ViewBag.Title = "ResetPassword";
}

@section scripts{

    <script type="text/javascript" src="@Url.For("ch.busy-indicator.js")"></script>

    <script type="text/javascript">

        (function (cheroes, $) {
            var btn = $('#submit').busyIndicator({ message: 'Resetting password...' });
            if (btn.data('show-modal') !== "") {
                $('#success-message').modal({
                    backdrop: false
                });
            }
        }(this.cheroes = this.cheroes || {}, jQuery));

    </script>
}

@using (var container = Html.FluentHtml().BootstrapModalContainer().ID("success-message").Begin())
{
    using (var dialog = container.CreateDialog().Begin())
    {
        using (var content = dialog.CreateModalContent().Begin())
        {
            using (var body = content.CreateBody().Begin())
            {
                @:Your password has been successfully reset.
            }
            using (var footer = content.CreateFooter().Begin())
            {
                <a href="@Url.HomeAction()" class="btn btn-primary">Continue</a>
            }
        }
    }
}

<div class="row">
    <div class="form-col-offset"></div>
    <div class="form-col">Please enter your email and a new password to complete resetting your password.</div>
</div>

<div class="row">
    <div class="form-col-offset"></div>
    <div class="form-col">
        @using (Html.FluentHtml().Form().Begin())
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(m => m.Code)

            <section class="form-group">
                @Html.ValidationSummary(excludePropertyErrors: true)
            </section>

            <section class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><span class="glyphicon glyphicon-envelope"></span></span>
                    @Html.FluentHtml().Input().For(x => x.Email).AutoFocus().ForBootstrap()
                </div>
                @Html.ValidationMessageFor(x => x.Email)
            </section>

            <section class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
                    @Html.FluentHtml().Input().For(x => x.Password).ForBootstrap()
                </div>
                @Html.ValidationMessageFor(x => x.Password)
            </section>

            <section class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
                    @Html.FluentHtml().Input().For(x => x.ConfirmPassword).ForBootstrap()
                </div>
                @Html.ValidationMessageFor(x => x.ConfirmPassword)
            </section>

            <section class="form-group">
                <span><input type="submit" id="submit" value="Reset Password" data-show-modal="@Model.IsSuccess" /></span>
                <a href="@Url.AccountLoginAction()" class="primary">Cancel</a>
            </section>
        }
    </div>
</div>
